# Natural2Verilog
# –û–ø–∏—Å–∞–Ω–∏–µ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ç–µ–∑–∏—Ä—É–µ–º–æ–≥–æ Verilog-–∫–æ–¥–∞ –∏–∑ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –Ω–∞ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–º —è–∑—ã–∫–µ. –í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –≤—ã –Ω–∞–π–¥–µ—Ç–µ:

- **–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö**: –ö–æ–¥—ã, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.
- **–ú–æ–¥—É–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö**: –°–∫—Ä–∏–ø—Ç—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ—Ä–º–∞—Ç–µ, –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–æ–¥–µ–ª—è–º–∏.
- **–ù–æ—É—Ç–±—É–∫–∏ –¥–æ–æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π**: Jupyter –Ω–æ—É—Ç–±—É–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∫–æ–¥ –¥–ª—è —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö.
- **–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º–æ–≥–æ –∫–æ–¥–∞, –≤–∫–ª—é—á–∞—è –º–µ—Ç–æ–¥—ã –æ—Ü–µ–Ω–∫–∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ç–µ–∑–∏—Ä—É–µ–º—ã—Ö Verilog-–º–æ–¥—É–ª–µ–π.
- **–ù–æ—É—Ç–±—É–∫–∏ —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π**: –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏–µ, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Verilog-–∫–æ–¥–∞ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –æ–ø–∏—Å–∞–Ω–∏–π.
- **–¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–µ–π**: –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –∑–∞–¥–∞—á–∞—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–¥–∞.

# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º

| –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞/–†–µ—Å—É—Ä—Å   | –í–µ—Ä—Å–∏—è/–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ  |
|---------------------|-------------------|
| Pytorch             | 2.2.0             |
| CUDA                | 8.6               |
| CUDA Toolkit        | 12.1              |
| Xformers            | 0.0.25            |
| –ü–∞–º—è—Ç—å GPU          | 16 –ì–ë             |

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Unsloth

–î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤, –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ [Unsloth](https://github.com/unslothai/unsloth). –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ [—Å—Å—ã–ª–∫–µ –Ω–∞ GitHub](https://github.com/unslothai/unsloth).

## –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–∏

–ú–æ–¥–µ–ª–∏ –∞–¥–∞–ø—Ç–µ—Ä–æ–≤ LoRA, –¥–æ–æ–±—É—á–µ–Ω–Ω—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Verilog-–∫–æ–¥–æ–≤, –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Hugging Face. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –∏—Ö –ø–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Å—ã–ª–∫–µ: [Driseri –Ω–∞ HuggingFace](https://huggingface.co/Driseri).

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏

–î–ª—è –∑–∞–ø—É—Å–∫–∞ –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:

```python
from unsloth import FastLanguageModel

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞
model, tokenizer = FastLanguageModel.from_pretrained(
    model_name="Driseri/lora3_newData_50step_r128",  # –£–∫–∞–∂–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≤–∞—à–µ–π –º–æ–¥–µ–ª–∏
    max_seq_length=512,       # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
    dtype='fp16',             # –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä 'fp16' –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
    load_in_4bit=True         # –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –≤ 4-–±–∏—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏
)

# –í–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ –≤—ã–≤–æ–¥–∞
FastLanguageModel.for_inference(model)

# –¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
inputs = tokenizer(
    [
        "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à Verilog –∑–∞–ø—Ä–æ—Å –∑–¥–µ—Å—å"
    ], 
    return_tensors="pt"
).to("cuda")

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞ –º–æ–¥–µ–ª–∏
outputs = model.generate(**inputs, max_new_tokens=64, use_cache=True)
print(tokenizer.batch_decode(outputs))
```

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `AutoModelForPeftCausalLM` –æ—Ç Hugging Face, –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ Unsloth. –°–ª–µ–¥—É–µ—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫—Ä–∞–π–Ω–µ –º–µ–¥–ª–µ–Ω–Ω—ã–º, —Ç–∞–∫ –∫–∞–∫ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–µ–π –≤ 4-–±–∏—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –≤ Unsloth –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ.

```python

from peft import AutoPeftModelForCausalLM
from transformers import AutoTokenizer

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞ –±–µ–∑ Unsloth
model = AutoPeftModelForCausalLM.from_pretrained(
    "lora_model",  # –£–∫–∞–∑–∞—Ç—å –º–æ–¥–µ–ª—å
    load_in_4bit=False  # –ó–∞–≥—Ä—É–∑–∫–∞ –≤ 4-–±–∏—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
)
tokenizer = AutoTokenizer.from_pretrained("lora_model")
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –≤ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–∞–ø–æ–∫, –∫–∞–∂–¥–∞—è –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞–ø–∫–∏:

- **Verilog-eval-progs**
  - –°–æ–¥–µ—Ä–∂–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ Verilog-–∫–æ–¥–∞.
  
- **Vgen**
  - –•—Ä–∞–Ω–∏—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ Verilog-–∫–æ–¥–∞.

- **generate_verilog**
  - –ü—Ä–∏–º–µ—Ä—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π Verilog —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.

- **hdlbits-solutions**
  - –†–µ—à–µ–Ω–∏—è —Å —Å–∞–π—Ç–∞ HDLBits, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞.

- **notebooks**
  - –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã Jupyter –Ω–æ—É—Ç–±—É–∫–æ–≤ —Å –∫–æ–¥–∞–º–∏ –¥–æ–æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–æ–¥–µ–ª–µ–π.

- **scripts**
  - –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

- **testbench**
  - –¢–µ—Å—Ç–æ–≤—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ Verilog-–º–æ–¥—É–ª–µ–π.

- **validate_results**
  - –î–∞—Ç–∞—Å–µ—Ç—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–≥—Ä–∞–º–º Verilog, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–∑–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.

üìÇ Verilog-eval-progs
  üìÇ Vgen
  üìÇ generate_verilog
  üìÇ hdlbits-solutions
  üìÇ notebooks
  üìÇ scripts
  üìÇ testbench
  üìÇ validate_results

